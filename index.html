<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>AR Гра про Україну</title>
  <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@master/aframe/build/aframe-ar.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      touch-action: none; /* блокує pinch zoom */
      font-family: Arial, sans-serif;
    }
    a-scene {
      width: 100%;
      height: 100%;
      position: fixed;
      top: 0;
      left: 0;
    }
    #scanText {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #FFD700;
      font-size: 2em;
      font-weight: bold;
      text-shadow: 2px 2px 6px #000;
      z-index: 10;
      text-align: center;
      width: 90%;
    }
    #smartLessaBtn {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #ff0044;
      color: white;
      padding: 14px 24px;
      border-radius: 30px;
      font-size: 1.1em;
      font-weight: bold;
      text-decoration: none;
      z-index: 10;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }
    #smartLessaBtn:hover {
      background: #cc0036;
    }
  </style>
</head>
<body>
  <div id="scanText">Наведи камеру на зображення Hiro маркера</div>

  <a-scene embedded id="arScene" arjs="sourceType: webcam; detectionMode: mono; trackingMethod: best; facingBack: true;">
    <a-marker id="marker" preset="hiro">
      <!-- Контейнер для гри -->
      <a-entity id="quiz-container" position="0 0 0" rotation="-90 0 0" scale="0.05 0.05 0.05">
        <a-text id="question-text" value="" position="-1 2 0" width="40" align="center" color="white"></a-text>
        <a-entity id="optionA" class="option" position="-1 1 0">
          <a-plane width="2" height="0.5" material="color: blue; opacity: 0.7"></a-plane>
          <a-text value="" width="35" align="left" color="white" position="-0.9 -0.2 0.01"></a-text>
        </a-entity>
        <a-entity id="optionB" class="option" position="-1 0.5 0">
          <a-plane width="2" height="0.5" material="color: blue; opacity: 0.7"></a-plane>
          <a-text value="" width="35" align="left" color="white" position="-0.9 -0.2 0.01"></a-text>
        </a-entity>
        <a-entity id="optionC" class="option" position="-1 0 0">
          <a-plane width="2" height="0.5" material="color: blue; opacity: 0.7"></a-plane>
          <a-text value="" width="35" align="left" color="white" position="-0.9 -0.2 0.01"></a-text>
        </a-entity>
        <a-entity id="optionD" class="option" position="-1 -0.5 0">
          <a-plane width="2" height="0.5" material="color: blue; opacity: 0.7"></a-plane>
          <a-text value="" width="35" align="left" color="white" position="-0.9 -0.2 0.01"></a-text>
        </a-entity>
        <a-entity id="result-container" visible="false">
          <a-text id="result-text" value="" position="-1 1 0" width="40" align="center" color="yellow"></a-text>
          <a-entity id="restart-btn" class="clickable" position="-1 0 0">
            <a-plane width="1.5" height="0.5" material="color: green; opacity: 0.7"></a-plane>
            <a-text value="Розпочати знову" width="20" align="center" color="white" position="-0.7 -0.2 0.01"></a-text>
          </a-entity>
        </a-entity>
      </a-entity>
    </a-marker>
    <a-entity camera>
      <a-cursor></a-cursor>
    </a-entity>
  </a-scene>

  <a href="https://youtube.com/playlist?list=PL6UDFwT9TzFxsVdFiEBsQ9yFpcYRPOpfO&si=IyXv1SkdPyvhcW7Z"
     id="smartLessaBtn" target="_blank">@SmartLessa</a>

  <script>
    const marker = document.getElementById('marker');
    const scanText = document.getElementById('scanText');
    const quizContainer = document.getElementById('quiz-container');
    const questionText = document.getElementById('question-text');
    const optionA = document.getElementById('optionA');
    const optionB = document.getElementById('optionB');
    const optionC = document.getElementById('optionC');
    const optionD = document.getElementById('optionD');
    const resultContainer = document.getElementById('result-container');
    const resultText = document.getElementById('result-text');
    const restartBtn = document.getElementById('restart-btn');

    // Питання про Україну
    const questions = [
      {
        question: "Яка столиця України?",
        options: ["A) Львів", "B) Київ", "C) Одеса", "D) Харків"],
        correct: "B"
      },
      {
        question: "Який колір прапора України?",
        options: ["A) Червоно-чорний", "B) Синьо-жовтий", "C) Біло-червоний", "D) Зелено-білий"],
        correct: "B"
      },
      {
        question: "Хто автор тексту гімну України?",
        options: ["A) Тарас Шевченко", "B) Іван Франко", "C) Павло Чубинський", "D) Леся Українка"],
        correct: "C"
      },
      {
        question: "Яка найвища гора в Україні?",
        options: ["A) Говерла", "B) Піп Іван", "C) Роман-Кош", "D) Петрос"],
        correct: "A"
      },
      {
        question: "Коли Україна здобула незалежність?",
        options: ["A) 1991 рік", "B) 1918 рік", "C) 1945 рік", "D) 2004 рік"],
        correct: "A"
      }
    ];

    let currentQuestion = 0;
    let score = 0;

    function startQuiz() {
      currentQuestion = 0;
      score = 0;
      resultContainer.setAttribute('visible', false);
      showQuestion();
    }

    function showQuestion() {
      if (currentQuestion < questions.length) {
        const q = questions[currentQuestion];
        questionText.setAttribute('value', q.question);
        optionA.querySelector('a-text').setAttribute('value', q.options[0]);
        optionB.querySelector('a-text').setAttribute('value', q.options[1]);
        optionC.querySelector('a-text').setAttribute('value', q.options[2]);
        optionD.querySelector('a-text').setAttribute('value', q.options[3]);
      } else {
        showResult();
      }
    }

    function handleAnswer(selected) {
      const q = questions[currentQuestion];
      if (selected === q.correct) {
        score++;
      }
      currentQuestion++;
      showQuestion();
    }

    function showResult() {
      questionText.setAttribute('value', '');
      optionA.querySelector('a-text').setAttribute('value', '');
      optionB.querySelector('a-text').setAttribute('value', '');
      optionC.querySelector('a-text').setAttribute('value', '');
      optionD.querySelector('a-text').setAttribute('value', '');
      let badge = '★'.repeat(score) + '☆'.repeat(5 - score);
      resultText.setAttribute('value', `Ви набрали ${score}/5 балів!\n${badge}`);
      resultContainer.setAttribute('visible', true);
    }

    // Додаємо обробники кліків
    optionA.addEventListener('click', () => handleAnswer('A'));
    optionB.addEventListener('click', () => handleAnswer('B'));
    optionC.addEventListener('click', () => handleAnswer('C'));
    optionD.addEventListener('click', () => handleAnswer('D'));
    restartBtn.addEventListener('click', startQuiz);

    // Події маркера
    marker.addEventListener('markerFound', () => {
      scanText.style.display = 'none';
      startQuiz();
    });

    marker.addEventListener('markerLost', () => {
      scanText.style.display = 'block';
    });

    // Перевірка доступу до камери
    navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } })
      .then(stream => {
        console.log('Доступ до задньої камери надано');
      })
      .catch(err => {
        scanText.textContent = 'Дозвольте доступ до задньої камери для AR';
        console.error('Помилка доступу до камери:', err);
      });

    // Фікс висоти для мобільних браузерів
    function fixHeight() {
      document.body.style.height = window.innerHeight + 'px';
    }
    window.addEventListener('resize', fixHeight);
    fixHeight();
  </script>
</body>
</html>